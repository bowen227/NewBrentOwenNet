<section class="main-container">
    <h2 class="p-3"><i class="fas fa-tasks mr-2"></i>CRM App</h2>
    <h3 class="ml-3" *ngIf="user != null">Welcome, {{ user.name }}</h3>
    <div class="form-container">
        <h3 class="ml-4 mt-3">Add New Company<i class="fas fa-plus-square ml-3" (click)="showForm('new')"></i></h3>
    </div>
    <div class="p-4 search-box-container form-group" *ngIf="contacts.length > 10;">
        <label for="searchTerm">Search Companies</label>
        <input type="text" class="form-control" name="searchTerm" [(ngModel)]="searchTerm" (ngModelChange)="searchContact($event)">
    </div>
    <div class="contact-container p-4">
        <h3>Companies</h3>
        <h5 *ngIf="!isLoading && contacts.length == 0">You haven't created any companies!</h5>
        <div class="spinner-border text-danger" *ngIf="isLoading" role="status">
            <span class="sr-only">Loading...</span>
        </div>
        <ul class="list-group list-group-flush" *ngIf="contacts.length > 0 && !showSearched || !isLoading">
            <li class="list-group-item" *ngFor="let c of contacts; let i = index;">
                <div class="d-flex flex-row">
                    <span class="flex-grow-1 mt-1 contact" routerLink="{{c.id}}">{{ c.companyName }}</span>
                    <i class="far fa-edit m-2" (click)="showForm(c.id)"></i>
                    <i class="far fa-trash-alt m-2" (click)="delete(c.id)"></i>
                </div>
            </li>
        </ul>
        <ul class="list-group list-group-flush" *ngIf="showSearched">
            <li class="list-group-item" *ngFor="let c of searchedContacts; let i = index;">
                <div class="d-flex flex-row">
                    <i class="far fa-edit m-2" (click)="showForm(c.id)"></i>
                    <i class="far fa-trash-alt m-2" (click)="delete(c.id)"></i>
                </div>
            </li>
        </ul>
    </div>
    <div class="edit-form-container d-flex flex-column justify-content-center align-items-center" *ngIf="showNewContactForm || showEditForm">
        <div class="edit-form">
            <h3 class="ml-4 mt-3">{{ showNewContactForm ? "New Company" : "Edit Company"}}</h3>
            <form class="container d-flex flex-column justify-content-around" [formGroup]="contactForm" (ngSubmit)="onSubmit()">
                <div class="form-group">
                    <label for="companyName">Company Name</label>
                    <input type="text" class="form-control" formControlName="companyName">
                </div>
                <div class="form-group">
                    <label for="street">Street</label>
                    <input type="text" class="form-control" formControlName="street">
                </div>
                <div class="form-group">
                    <label for="city">City</label>
                    <input type="text" class="form-control" formControlName="city">
                </div>
                <div class="form-group">
                    <label for="state">State</label>
                    <input type="text" class="form-control" formControlName="state">
                </div>
                <div class="form-group">
                    <label for="zip">Zip</label>
                    <input type="text" class="form-control" formControlName="zip">
                </div>
                <div class="form-group">
                    <label for="phone">Phone</label>
                    <input type="tel" class="form-control" formControlName="phone">
                </div>
                <div class="form-group">
                    <label for="fax">Fax</label>
                    <input type="tel" class="form-control" formControlName="fax">
                </div>
                <button type="submit" class="btn">Save</button>
            </form>
        </div>
    </div>
    <div class="indev-container d-flex flex-column align-items-center justify-content-center" *ngIf="indevPopup">
        <div class="indev d-flex flex-column align-items-center justify-content-center p-3">
            <div>
                <h3>Currently in development</h3>
                <!-- <p>Backend not completely implemented. Some features not working or completed.</p> -->
                <p>
                    You are able to add, update and delete companies as well as navigate to company details page.
                    You can add, update, delete company contacts from the details page. Your information will not
                    be saved unless you've logged in.
                </p>
                <button class="btn" (click)="togglePopup()">Close</button>
            </div>
        </div>
    </div>
</section>
